<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Cost and Affordability of a Healthy Diet Dashboard</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/PapaParse/5.4.1/papaparse.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/d3/7.8.5/d3.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/topojson/3.0.2/topojson.min.js"></script>
<style>
* {
    margin: 0;
    padding: 0;
    box-sizing: border-box;
}

body {
    font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
    background-color: #f9fafb;
    color: #374151;
    line-height: 1.6;
}

body.dark-mode {
    background-color: #1f2937;
    color: #e5e7eb;
}

.container {
    max-width: 1400px;
    margin: 0 auto;
    padding: 2rem;
}

.header {
    text-align: center;
    margin-bottom: 3rem;
}

.header h1 {
    font-size: 2.5rem;
    font-weight: bold;
    color: #1f2937;
    margin-bottom: 0.5rem;
}

body.dark-mode .header h1 {
    color: #f9fafb;
}

.header p {
    color: #6b7280;
    font-size: 1.1rem;
    margin-bottom: 0.5rem;
}

.header .attribution {
    color: #9ca3af;
    font-size: 0.875rem;
    font-style: italic;
}

.data-source-selector {
    display: flex;
    justify-content: center;
    gap: 1rem;
    margin-bottom: 2rem;
}

.source-btn {
    padding: 0.75rem 1.5rem;
    border-radius: 0.5rem;
    font-weight: 500;
    cursor: pointer;
    border: 2px solid;
    font-size: 0.875rem;
    transition: all 0.2s;
    min-width: 150px;
}

.source-btn.active {
    background-color: #2563eb;
    color: white;
    border-color: #2563eb;
}

.source-btn.inactive {
    background-color: white;
    color: #374151;
    border-color: #d1d5db;
}

body.dark-mode .source-btn.inactive {
    background-color: #374151;
    color: #e5e7eb;
    border-color: #4b5563;
}

.source-btn:hover {
    transform: translateY(-1px);
    box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
}

.theme-toggle {
    position: fixed;
    top: 1rem;
    right: 1rem;
    background: white;
    border: 2px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 0.5rem;
    cursor: pointer;
    font-size: 1.5rem;
    z-index: 1000;
}

body.dark-mode .theme-toggle {
    background: #374151;
    border-color: #4b5563;
}

.performance-metrics {
    position: fixed;
    bottom: 1rem;
    right: 1rem;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 0.5rem;
    padding: 0.5rem;
    font-size: 0.75rem;
    color: #6b7280;
}

body.dark-mode .performance-metrics {
    background: #374151;
    border-color: #4b5563;
    color: #9ca3af;
}

.stats-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 1.5rem;
    margin-bottom: 3rem;
}

.stat-card {
    background: white;
    padding: 1.5rem;
    border-radius: 0.75rem;
    border: 2px solid;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
}

body.dark-mode .stat-card {
    background: #374151;
}

.stat-card.blue {
    background-color: #eff6ff;
    border-color: #bfdbfe;
}

body.dark-mode .stat-card.blue {
    background-color: #1e3a8a;
    border-color: #3b82f6;
}

.stat-card.red {
    background-color: #fef2f2;
    border-color: #fecaca;
}

body.dark-mode .stat-card.red {
    background-color: #7f1d1d;
    border-color: #dc2626;
}

.stat-card.orange {
    background-color: #fff7ed;
    border-color: #fed7aa;
}

body.dark-mode .stat-card.orange {
    background-color: #7c2d12;
    border-color: #ea580c;
}

.stat-card.green {
    background-color: #f0fdf4;
    border-color: #bbf7d0;
}

body.dark-mode .stat-card.green {
    background-color: #14532d;
    border-color: #16a34a;
}

.stat-card h3 {
    font-size: 0.875rem;
    font-weight: 600;
    margin-bottom: 0.5rem;
}

.stat-card .value {
    font-size: 2rem;
    font-weight: bold;
    margin-bottom: 0.25rem;
}

.stat-card .unit {
    font-size: 0.75rem;
    opacity: 0.8;
}

.blue h3, .blue .value { color: #1d4ed8; }
.red h3, .red .value { color: #dc2626; }
.orange h3, .orange .value { color: #ea580c; }
.green h3, .green .value { color: #16a34a; }

body.dark-mode .blue h3, body.dark-mode .blue .value { color: #60a5fa; }
body.dark-mode .red h3, body.dark-mode .red .value { color: #f87171; }
body.dark-mode .orange h3, body.dark-mode .orange .value { color: #fb923c; }
body.dark-mode .green h3, body.dark-mode .green .value { color: #4ade80; }

.year-toggle, .income-filter {
    display: flex;
    justify-content: center;
    gap: 0.5rem;
    margin-bottom: 1.5rem;
    flex-wrap: wrap;
}

.year-btn, .income-btn {
    padding: 0.5rem 1rem;
    border-radius: 0.375rem;
    border: 1px solid #d1d5db;
    background: white;
    color: #374151;
    cursor: pointer;
    font-size: 0.875rem;
    transition: all 0.2s;
}

body.dark-mode .year-btn, body.dark-mode .income-btn {
    background: #374151;
    color: #e5e7eb;
    border-color: #4b5563;
}

.year-btn.active, .income-btn.active {
    background: #2563eb;
    color: white;
    border-color: #2563eb;
}

.year-btn:hover, .income-btn:hover {
    background: #e5e7eb;
}

body.dark-mode .year-btn:hover, body.dark-mode .income-btn:hover {
    background: #4b5563;
}

.year-btn.active:hover, .income-btn.active:hover {
    background: #1d4ed8;
}

.controls {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.75rem;
    margin-bottom: 2rem;
    border: 1px solid #e5e7eb;
}

body.dark-mode .controls {
    background: #1f2937;
    border-color: #374151;
}

.controls-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
    gap: 1rem;
}

.control-group {
    display: flex;
    flex-direction: column;
}

.control-group label {
    font-size: 0.875rem;
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
}

body.dark-mode .control-group label {
    color: #e5e7eb;
}

.control-group select {
    padding: 0.5rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 0.875rem;
    background: white;
}

body.dark-mode .control-group select {
    background: #374151;
    color: #e5e7eb;
    border-color: #4b5563;
}

.control-group select[multiple] {
    height: 120px;
}

.control-group input[type="text"] {
    padding: 0.5rem;
    border: 1px solid #d1d5db;
    border-radius: 0.375rem;
    font-size: 0.875rem;
}

body.dark-mode .control-group input[type="text"] {
    background: #374151;
    color: #e5e7eb;
    border-color: #4b5563;
}

.checkbox-group {
    display: flex;
    align-items: center;
    margin-top: 1rem;
}

.checkbox-group input {
    margin-right: 0.5rem;
}

.btn {
    padding: 0.5rem 1rem;
    border-radius: 0.5rem;
    font-weight: 500;
    cursor: pointer;
    border: none;
    font-size: 0.875rem;
    transition: all 0.2s;
}

.btn-primary {
    background-color: #2563eb;
    color: white;
}

.btn-primary:hover {
    background-color: #1d4ed8;
}

.btn-secondary {
    background-color: #e5e7eb;
    color: #374151;
}

body.dark-mode .btn-secondary {
    background-color: #4b5563;
    color: #e5e7eb;
}

.btn-secondary:hover {
    background-color: #d1d5db;
}

body.dark-mode .btn-secondary:hover {
    background-color: #6b7280;
}

.nav-buttons {
    display: flex;
    gap: 0.5rem;
    margin-bottom: 2rem;
}

.charts-container {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(600px, 1fr));
    gap: 2rem;
    margin-bottom: 2rem;
}

.chart-card {
    background: white;
    padding: 1.5rem;
    border-radius: 0.75rem;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    position: relative;
}

body.dark-mode .chart-card {
    background: #374151;
}

.chart-card h2 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

body.dark-mode .chart-card h2 {
    color: #f9fafb;
}

.chart-container {
    position: relative;
    height: 400px;
    width: 100%;
}

.chart-placeholder {
    display: flex;
    align-items: center;
    justify-content: center;
    height: 100%;
    background: #f3f4f6;
    border-radius: 0.5rem;
    color: #6b7280;
}

body.dark-mode .chart-placeholder {
    background: #1f2937;
    color: #9ca3af;
}

.chart-zoom-controls {
    position: absolute;
    top: 1rem;
    right: 1rem;
    display: flex;
    gap: 0.5rem;
}

.zoom-btn {
    padding: 0.25rem 0.5rem;
    background: white;
    border: 1px solid #e5e7eb;
    border-radius: 0.25rem;
    cursor: pointer;
    font-size: 0.75rem;
}

body.dark-mode .zoom-btn {
    background: #374151;
    border-color: #4b5563;
    color: #e5e7eb;
}

.table-container {
    background: white;
    border-radius: 0.75rem;
    overflow: hidden;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
    margin-bottom: 2rem;
}

body.dark-mode .table-container {
    background: #374151;
}

.table-container h2 {
    font-size: 1.25rem;
    font-weight: 600;
    color: #1f2937;
    padding: 1.5rem 1.5rem 1rem;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

body.dark-mode .table-container h2 {
    color: #f9fafb;
}

table {
    width: 100%;
    border-collapse: collapse;
}

th, td {
    padding: 0.75rem 1rem;
    text-align: left;
    border-bottom: 1px solid #e5e7eb;
}

body.dark-mode th, body.dark-mode td {
    border-bottom-color: #4b5563;
}

th {
    background-color: #f9fafb;
    font-weight: 600;
    font-size: 0.75rem;
    text-transform: uppercase;
    color: #6b7280;
}

body.dark-mode th {
    background-color: #1f2937;
    color: #9ca3af;
}

.text-right {
    text-align: right;
}

.text-red { color: #dc2626; }
.text-orange { color: #ea580c; }
.text-green { color: #16a34a; }

.loading {
    display: flex;
    justify-content: center;
    align-items: center;
    height: 200px;
    font-size: 1.125rem;
}

.hidden {
    display: none;
}

.info-card {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.75rem;
    border: 1px solid #e5e7eb;
}

body.dark-mode .info-card {
    background: #1f2937;
    border-color: #374151;
}

.info-card h3 {
    font-size: 1.125rem;
    font-weight: 600;
    color: #1f2937;
    margin-bottom: 1rem;
}

body.dark-mode .info-card h3 {
    color: #f9fafb;
}

.info-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 1.5rem;
}

.info-section h4 {
    font-weight: 500;
    color: #374151;
    margin-bottom: 0.5rem;
}

body.dark-mode .info-section h4 {
    color: #e5e7eb;
}

.info-section ul {
    list-style: none;
    font-size: 0.875rem;
    color: #6b7280;
}

body.dark-mode .info-section ul {
    color: #9ca3af;
}

.info-section li {
    margin-bottom: 0.25rem;
}

.small-text {
    font-size: 0.75rem;
    color: #6b7280;
    margin-top: 1rem;
    padding-top: 1rem;
    border-top: 1px solid #e5e7eb;
}

body.dark-mode .small-text {
    color: #9ca3af;
    border-top-color: #4b5563;
}

.map-controls {
    background: #f9fafb;
    padding: 1.5rem;
    border-radius: 0.75rem;
    margin-bottom: 2rem;
    border: 1px solid #e5e7eb;
}

body.dark-mode .map-controls {
    background: #1f2937;
    border-color: #374151;
}

.map-container {
    position: relative;
    background: white;
    border: 2px solid #e5e7eb;
    overflow: hidden;
}

body.dark-mode .map-container {
    background: #374151;
    border-color: #4b5563;
}

body.dark-mode .map-legend {
    background: #1f2937 !important;
    border-color: #374151 !important;
}

#map-tooltip {
    background: white !important;
    color: #374151 !important;
    border: 1px solid #d1d5db !important;
    border-radius: 4px !important;
    padding: 8px 12px !important;
    font-size: 0.875rem !important;
    box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1) !important;
    pointer-events: none !important;
    z-index: 1000 !important;
}

body.dark-mode #map-tooltip {
    background: #374151 !important;
    color: #e5e7eb !important;
    border-color: #4b5563 !important;
}

@media (max-width: 768px) {
    .container {
        padding: 1rem;
    }
    
    .header h1 {
        font-size: 2rem;
    }
    
    .charts-container {
        grid-template-columns: 1fr;
    }
    
    .controls-grid {
        grid-template-columns: 1fr;
    }

    .data-source-selector {
        flex-direction: column;
        align-items: center;
    }

    .nav-buttons {
        flex-direction: column;
    }
}
</style>
</head>
<body>
<div class="container">
<div class="header">
    <h1>Cost and Affordability of a Healthy Diet</h1>
    <p>Comprehensive analysis of economic access to nutritious foods worldwide</p>
    <div class="attribution">Dashboard developed by <a href="https://www.linkedin.com/in/frankbueltge/" target="_blank">Frank Bueltge</a> for <a href="https://data-snack.com" target="_blank">data-snack.com</a></div>
</div>

<!-- Data Source Selector -->
<div class="data-source-selector">
    <button class="source-btn active" id="map-source-btn">World Map</button>
    <button class="source-btn inactive" id="regions-source-btn">Regional Analysis</button>
    <button class="source-btn inactive" id="countries-source-btn">Country Analysis</button>
</div>

<div id="loading" class="loading">
    Loading FAOSTAT Data...
</div>

<div id="app" class="hidden">
    <!-- Theme Toggle Button -->
    <button class="theme-toggle" id="theme-toggle" onclick="toggleTheme()">🌙</button>
    
    <!-- Performance Metrics -->
    <div class="performance-metrics" id="performance-metrics">
        <div>Load Time: <span id="load-time">0ms</span></div>
        <div>Charts: <span id="charts-loaded">0/0</span></div>
    </div>

    <!-- Global Statistics -->
    <div class="stats-grid">
        <div class="stat-card blue">
            <h3 id="stat-1-title">Global Cost (PPP)</h3>
            <div class="value" id="stat-1-value">$0.00</div>
            <div class="unit" id="stat-1-unit">per person per day</div>
        </div>
        <div class="stat-card red">
            <h3 id="stat-2-title">Global Unaffordability</h3>
            <div class="value" id="stat-2-value">0%</div>
            <div class="unit" id="stat-2-unit">of population</div>
        </div>
        <div class="stat-card orange">
            <h3 id="stat-3-title">People Affected</h3>
            <div class="value" id="stat-3-value">0M</div>
            <div class="unit" id="stat-3-unit">billion people affected</div>
        </div>
        <div class="stat-card green">
            <h3 id="stat-4-title">Average Cost</h3>
            <div class="value" id="stat-4-value">$0.00</div>
            <div class="unit" id="stat-4-unit">average cost</div>
        </div>
    </div>

    <!-- Navigation -->
    <div class="nav-buttons">
        <button class="btn btn-secondary" id="overview-btn">Global Overview</button>
        <button class="btn btn-secondary" id="analysis-btn">Detailed Analysis</button>
    </div>

    <!-- Overview View -->
    <div id="overview-view">
        <!-- Historical Data Toggle -->
        <div class="year-toggle" id="year-toggle">
            <button class="year-btn" data-year="2017">2017</button>
            <button class="year-btn" data-year="2018">2018</button>
            <button class="year-btn" data-year="2019">2019</button>
            <button class="year-btn" data-year="2020">2020</button>
            <button class="year-btn" data-year="2021">2021</button>
            <button class="year-btn" data-year="2022">2022</button>
            <button class="year-btn" data-year="2023">2023</button>
            <button class="year-btn active" data-year="2024">2024</button>
        </div>

        <!-- Income Level Filter (only for countries) -->
        <div class="income-filter" id="income-filter" style="display: none;">
            <button class="income-btn active" data-income="all">All Countries</button>
            <button class="income-btn" data-income="high">High Income</button>
            <button class="income-btn" data-income="upper-middle">Upper Middle</button>
            <button class="income-btn" data-income="lower-middle">Lower Middle</button>
            <button class="income-btn" data-income="low">Low Income</button>
        </div>

        <div class="charts-container">
            <div class="chart-card" data-chart="cost-chart">
                <h2 id="chart-1-title">
                    <span>Top 15 Most Expensive (Int$ PPP/day)</span>
                </h2>
                <div class="chart-zoom-controls">
                    <button class="zoom-btn" onclick="resetChartZoom('cost-chart')">🔍 Reset Zoom</button>
                    <button class="zoom-btn" onclick="toggleChartFullscreen('cost-chart')">⛶ Fullscreen</button>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder" id="cost-chart-placeholder">Loading chart...</div>
                    <canvas id="cost-chart" style="display: none;"></canvas>
                </div>
            </div>
            <div class="chart-card" data-chart="affordability-chart">
                <h2 id="chart-2-title">
                    <span>Top 15 Least Affordable (%)</span>
                </h2>
                <div class="chart-zoom-controls">
                    <button class="zoom-btn" onclick="resetChartZoom('affordability-chart')">🔍 Reset Zoom</button>
                    <button class="zoom-btn" onclick="toggleChartFullscreen('affordability-chart')">⛶ Fullscreen</button>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder" id="affordability-chart-placeholder">Loading chart...</div>
                    <canvas id="affordability-chart" style="display: none;"></canvas>
                </div>
            </div>
        </div>

        <div class="charts-container">
            <div class="chart-card" data-chart="best-affordability-chart">
                <h2 id="chart-3-title">
                    <span>Top 15 Most Affordable (Lowest Unaffordability %)</span>
                </h2>
                <div class="chart-zoom-controls">
                    <button class="zoom-btn" onclick="resetChartZoom('best-affordability-chart')">🔍 Reset Zoom</button>
                    <button class="zoom-btn" onclick="toggleChartFullscreen('best-affordability-chart')">⛶ Fullscreen</button>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder" id="best-affordability-chart-placeholder">Loading chart...</div>
                    <canvas id="best-affordability-chart" style="display: none;"></canvas>
                </div>
            </div>
            <div class="chart-card" data-chart="cost-vs-affordability-chart">
                <h2 id="chart-4-title">
                    <span>Cost vs Affordability</span>
                </h2>
                <div class="chart-zoom-controls">
                    <button class="zoom-btn" onclick="resetChartZoom('cost-vs-affordability-chart')">🔍 Reset Zoom</button>
                    <button class="zoom-btn" onclick="toggleChartFullscreen('cost-vs-affordability-chart')">⛶ Fullscreen</button>
                </div>
                <div class="chart-container">
                    <div class="chart-placeholder" id="cost-vs-affordability-chart-placeholder">Loading chart...</div>
                    <canvas id="cost-vs-affordability-chart" style="display: none;"></canvas>
                </div>
            </div>
        </div>

        <div class="charts-container">
            <div class="table-container">
                <h2 id="table-1-title">
                    <span>Complete Ranking - Cost (Int$ PPP/day)</span>
                </h2>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th id="table-1-header">Region</th>
                            <th class="text-right">Cost</th>
                            <th class="text-right">Unaffordability</th>
                            <th class="text-right">Affected (M)</th>
                        </tr>
                    </thead>
                    <tbody id="cost-ranking-table">
                    </tbody>
                </table>
            </div>
            <div class="table-container">
                <h2 id="table-2-title">
                    <span>Complete Ranking - Unaffordability (%)</span>
                </h2>
                <table>
                    <thead>
                        <tr>
                            <th>Rank</th>
                            <th id="table-2-header">Region</th>
                            <th class="text-right">Unaffordable</th>
                            <th class="text-right">Cost (PPP)</th>
                            <th class="text-right">Affected (M)</th>
                        </tr>
                    </thead>
                    <tbody id="affordability-ranking-table">
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Analysis View -->
    <div id="analysis-view" class="hidden">
        <div class="controls">
            <div class="controls-grid">
                <div class="control-group">
                    <label for="areas-select" id="areas-select-label">Select Regions</label>
                    <select id="areas-select" multiple></select>
                    <small style="color: #6b7280; margin-top: 0.25rem;">Hold Ctrl/Cmd to select multiple</small>
                </div>
                <div class="control-group" id="continent-group" style="display: none;">
                    <label for="continent-select">Select Continents</label>
                    <select id="continent-select" multiple>
                        <option value="Africa">Africa</option>
                        <option value="Asia">Asia</option>
                        <option value="Europe">Europe</option>
                        <option value="North America">North America</option>
                        <option value="South America">South America</option>
                        <option value="Oceania">Oceania</option>
                    </select>
                    <small style="color: #6b7280; margin-top: 0.25rem;">Hold Ctrl/Cmd to select multiple</small>
                </div>
                <div class="control-group" id="search-group">
                    <label for="area-search" id="area-search-label">Search Countries</label>
                    <input type="text" id="area-search" placeholder="Type to search countries...">
                </div>
                <div class="control-group">
                    <label for="indicator-select">Indicator</label>
                    <select id="indicator-select">
                        <option value="cohd_ppp">Cost of Healthy Diet (PPP)</option>
                        <option value="pua">People Unable to Afford (%)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="year-select">Year</label>
                    <select id="year-select">
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024" selected>2024</option>
                    </select>
                </div>
                <div class="control-group">
                    <label>View Mode</label>
                    <div class="checkbox-group">
                        <input type="checkbox" id="time-series-checkbox">
                        <label for="time-series-checkbox">Time Series (2017-2024)</label>
                    </div>
                </div>
            </div>
        </div>

        <div class="chart-card">
            <h2 id="analysis-chart-title">
                <span>Regional Comparison: Cost of Healthy Diet (PPP)</span>
            </h2>
            <div class="chart-zoom-controls">
                <button class="zoom-btn" onclick="resetChartZoom('analysis-chart')">🔍 Reset Zoom</button>
                <button class="zoom-btn" onclick="toggleChartFullscreen('analysis-chart')">⛶ Fullscreen</button>
            </div>
            <div class="chart-container">
                <canvas id="analysis-chart"></canvas>
            </div>
        </div>

        <div class="table-container">
            <h2 id="analysis-table-title">
                <span>Detailed Data Overview</span>
            </h2>
            <table>
                <thead id="analysis-table-header">
                    <tr>
                        <th id="analysis-table-area-header">Region</th>
                        <th class="text-right">Cost (PPP)</th>
                        <th class="text-right">Unaffordability (%)</th>
                        <th class="text-right">Affected (Million)</th>
                    </tr>
                </thead>
                <tbody id="analysis-table-body">
                </tbody>
            </table>
        </div>
    </div>

    <!-- Map View -->
    <div id="map-view" class="hidden">
        <div class="map-controls">
            <div class="controls-grid">
                <div class="control-group">
                    <label for="map-indicator-select">Indicator</label>
                    <select id="map-indicator-select">
                        <option value="cohd_ppp">Cost of Healthy Diet (PPP)</option>
                        <option value="pua">People Unable to Afford (%)</option>
                    </select>
                </div>
                <div class="control-group">
                    <label for="map-year-select">Year</label>
                    <select id="map-year-select">
                        <option value="2017">2017</option>
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                        <option value="2021">2021</option>
                        <option value="2022">2022</option>
                        <option value="2023">2023</option>
                        <option value="2024" selected>2024</option>
                    </select>
                </div>
            </div>
        </div>
        
        <div class="chart-card">
            <h2>
                <span id="map-title">Global Cost of Healthy Diet - 2024</span>
            </h2>
            <div class="map-container" id="world-map" style="height: 600px; position: relative;">
                <svg id="map-svg" width="100%" height="100%"></svg>
                <div id="map-tooltip" style="position: absolute; display: none;"></div>
            </div>
            <div class="map-legend" style="margin-top: 1rem; padding: 1rem; background: #f9fafb; border-radius: 0.5rem; border: 1px solid #e5e7eb;">
                <h4 style="font-size: 0.875rem; font-weight: 600; margin-bottom: 0.5rem;">Legend</h4>
                <div id="map-legend-content" style="display: flex; gap: 1rem; flex-wrap: wrap; font-size: 0.75rem;">
                    <!-- Legend items will be added dynamically -->
                </div>
            </div>
        </div>

        <div class="table-container">
            <h2>
                <span>Country Data for Selected Year</span>
            </h2>
            <table>
                <thead>
                    <tr>
                        <th>Country</th>
                        <th class="text-right">Cost (PPP)</th>
                        <th class="text-right">Unaffordability (%)</th>
                        <th class="text-right">Affected (Million)</th>
                    </tr>
                </thead>
                <tbody id="map-table-body">
                </tbody>
            </table>
        </div>
    </div>

    <!-- Data Sources & Methodology -->
    <div class="info-card">
        <h3>Data Sources & Methodology</h3>
        <div class="info-grid">
            <div class="info-section">
                <h4>Healthy Diet Basket (HDB)</h4>
                <ul>
                    <li>• <strong>Energy Target:</strong> 2,330 kcal per day</li>
                    <li>• <strong>Starchy Staples:</strong> 50% of dietary energy</li>
                    <li>• <strong>Animal Foods:</strong> 13% (protein source)</li>
                    <li>• <strong>Fruits & Vegetables:</strong> 12% combined</li>
                </ul>
            </div>
            <div class="info-section">
                <h4>Data Sources</h4>
                <ul>
                    <li>• <strong>Primary Dataset:</strong> FAO Cost and Affordability of a Healthy Diet (CoAHD)</li>
                    <li>• <strong>Price Data:</strong> International Comparison Program (ICP) 2021</li>
                    <li>• <strong>Updates:</strong> National Consumer Price Index (CPI)</li>
                    <li>• <strong>Coverage:</strong> 173 countries & territories, 2017-2024</li>
                    <li>• <strong>Affordability:</strong> Based on World Bank poverty lines & income distributions</li>
                </ul>
            </div>
        </div>
        <div class="small-text">
             <strong>Source:</strong> FAO Statistics Division (<a href="https://www.fao.org/faostat/en/#data/CAHD" target="_blank">FAOSTAT</a>) | 
            <strong>Methodology:</strong> Food-based dietary guidelines using least-cost optimization approach | 
            <strong>Last Updated:</strong> August 2025 | Dashboard by <a href="https://www.linkedin.com/in/frankbueltge/" target="_blank">Frank Bueltge</a> for <a href="https://data-snack.com" target="_blank">data-snack.com</a>
        </div>
    </div>
</div>
</div>

<!-- External JavaScript -->
<script src="dashboard.js"></script>
</body>
</html>